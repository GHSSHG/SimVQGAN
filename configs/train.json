{
  "seed": 42,
  "train": {
    "epochs": 3,
    "batch_size": 2048,
    "data_parallel": true,
    "learning_rate": 0.0002,
    "host_prefetch_size": 64,
    "device_prefetch_size": 16,
    "grad_clip": 1.0,
    "disc_start_step": 10000,
    "disc_warmup_steps": 20000,
    "log_every_steps": 200,
    "loss_weights": {
      "time_l1": 5.0,
      "gan": 0.03,
      "feature": 0.1
    }
  },
  "model": {
    "base_channels": 32,
    "enc_channels": [
      64,
      64,
      128,
      128,
      256
    ],
    "enc_down_strides": [
      2,
      4,
      5,
      1
    ],
    "enc_num_res_blocks": 2,
    "latent_dim": 256,
    "codebook_size": 65536,
    "dec_channels": [
      256,
      128,
      128,
      64,
      64
    ],
    "dec_up_strides": [
      1,
      5,
      4,
      2
    ],
    "dec_num_res_blocks": 2,
    "remat_encoder": false,
    "remat_decoder": false,
    "discriminator": {
      "channels": [
        32,
        64,
        128,
        256
      ],
      "strides": [
        2,
        2,
        2,
        2
      ],
      "kernel_size": 15,
      "resblock_layers": 2,
      "remat": false
    },
    "pre_quant_transformer_layers": 2,
    "post_quant_transformer_layers": 2,
    "transformer_heads": 8,
    "transformer_mlp_ratio": 4.0,
    "transformer_dropout": 0.1,
    "remat_transformer": false,
    "compute_dtype": "bf16",
    "disc_dtype": "bf16",
    "param_dtype": "fp32",
    "diveq_sigma2": 0.001,
    "search_chunk_size": 2048
  },
  "data": {
    "type": "pod5",
    "root": "/data/nanopore/hereditary_cancer_2025.09/raw",
    "segment_sec": 1.0,
    "segment_samples": 5000,
    "sample_rate": 5000,
    "subdirs": [
      "FC01/pod5",
      "FC02/pod5",
      "FC03/pod5"
    ],
    "loader_workers": 24,
    "loader_prefetch_chunks": 1024,
    "train": {
      "root": "/data/nanopore/hereditary_cancer_2025.09/raw",
      "subdirs": [
        "FC01/pod5",
        "FC02/pod5",
        "FC03/pod5"
      ],
      "segment_samples": 5000
    }
  },
  "checkpoint": {
    "dir": "checkpoints",
    "resume_from": null,
    "every_steps": 5000
  },
  "logging": {
    "wandb": {
      "enabled": true,
      "project": "simvq-local",
      "run_name": "v2.0",
      "api_key": "2cdf3f560280d95e52c84f09e48885bd40afc155"
    }
  },
  "optim": {
    "disc_lr_mult": 0.15,
    "freeze_W": false
  }
}
